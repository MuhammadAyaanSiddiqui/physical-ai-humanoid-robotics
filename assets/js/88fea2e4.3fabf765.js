"use strict";(globalThis.webpackChunkphysical_ai_course=globalThis.webpackChunkphysical_ai_course||[]).push([[8298],{4450:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"module-2-simulation/ch6-unity/interactive-scenarios","title":"Creating Interactive Scenarios in Unity","description":"One of Unity\'s greatest strengths is its powerful UI framework and component-based architecture, which make it easy to build interactive scenarios for your robot. You can create user interfaces to send commands, display sensor data, or build complex simulations for testing your robot\'s behavior.","source":"@site/docs/module-2-simulation/ch6-unity/interactive-scenarios.md","sourceDirName":"module-2-simulation/ch6-unity","slug":"/module-2-simulation/ch6-unity/interactive-scenarios","permalink":"/physical-ai-humanoid-robotics/docs/module-2-simulation/ch6-unity/interactive-scenarios","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module-2-simulation/ch6-unity/interactive-scenarios.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Unity to ROS 2 Communication with the TCP Connector","permalink":"/physical-ai-humanoid-robotics/docs/module-2-simulation/ch6-unity/tcp-ros2-comm"},"next":{"title":"Module 2 Assessment: Simulation Project","permalink":"/physical-ai-humanoid-robotics/docs/module-2-simulation/assessment"}}');var s=i(4848),r=i(8453);const o={},c="Creating Interactive Scenarios in Unity",l={},a=[{value:"1. Building a UI with Unity UI",id:"1-building-a-ui-with-unity-ui",level:2},{value:"2. Designing an Interactive Scenario: Pick and Place",id:"2-designing-an-interactive-scenario-pick-and-place",level:2}];function d(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"creating-interactive-scenarios-in-unity",children:"Creating Interactive Scenarios in Unity"})}),"\n",(0,s.jsx)(n.p,{children:"One of Unity's greatest strengths is its powerful UI framework and component-based architecture, which make it easy to build interactive scenarios for your robot. You can create user interfaces to send commands, display sensor data, or build complex simulations for testing your robot's behavior."}),"\n",(0,s.jsx)(n.p,{children:"This lesson will cover how to create a simple UI to control your robot and how to set up a basic interactive scenario."}),"\n",(0,s.jsx)(n.h2,{id:"1-building-a-ui-with-unity-ui",children:"1. Building a UI with Unity UI"}),"\n",(0,s.jsx)(n.p,{children:"Let's create a simple UI with a button to send a command to our robot via ROS 2."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Step 1: Create a Canvas"})}),"\n",(0,s.jsxs)(n.p,{children:["All UI elements in Unity must be inside a ",(0,s.jsx)(n.code,{children:"Canvas"}),"."]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["In the Hierarchy window, right-click and select ",(0,s.jsx)(n.strong,{children:"UI > Canvas"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["This will create a Canvas object and an ",(0,s.jsx)(n.code,{children:"EventSystem"})," object. The ",(0,s.jsx)(n.code,{children:"EventSystem"})," is required to handle input like clicks and drags."]}),"\n",(0,s.jsxs)(n.li,{children:["Select the Canvas and in the Inspector, set the ",(0,s.jsx)(n.strong,{children:"UI Scale Mode"})," to ",(0,s.jsx)(n.strong,{children:"Scale With Screen Size"}),". This makes your UI responsive to different screen resolutions."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Step 2: Add a Button"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Right-click on your Canvas in the Hierarchy and select ",(0,s.jsx)(n.strong,{children:"UI > Button - TextMeshPro"}),".","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["If it's your first time using TextMeshPro, Unity will prompt you to import essential resources. Click ",(0,s.jsx)(n.strong,{children:"Import TMP Essentials"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["A button will appear in your scene. You can position it using the ",(0,s.jsx)(n.code,{children:"Rect Transform"})," component in the Inspector."]}),"\n",(0,s.jsxs)(n.li,{children:["Expand the Button object in the Hierarchy and select the ",(0,s.jsx)(n.code,{children:"Text (TMP)"})," child object. In its Inspector, change the ",(0,s.jsx)(n.code,{children:"Text"}),' field to "Send Command".']}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Step 3: Scripting the Button's Action"})}),"\n",(0,s.jsx)(n.p,{children:"Now, let's make the button publish a ROS 2 message when clicked."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Create a new C# script called ",(0,s.jsx)(n.code,{children:"UIController.cs"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:['Attach this script to your "RosManager" ',(0,s.jsx)(n.code,{children:"GameObject"})," (or any other persistent object)."]}),"\n",(0,s.jsx)(n.li,{children:"Edit the script:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'using UnityEngine;\nusing Unity.Robotics.ROSTCPConnector;\nusing RosMessageTypes.Std;\n\npublic class UIController : MonoBehaviour\n{\n    private ROSConnection ros;\n    private string topicName = "ui_commands";\n\n    void Start()\n    {\n        ros = ROSConnection.GetOrCreateInstance();\n        ros.RegisterPublisher<StringMsg>(topicName);\n    }\n\n    public void PublishCommand()\n    {\n        StringMsg message = new StringMsg("Button Clicked!");\n        ros.Publish(topicName, message);\n        Debug.Log("Sent command: Button Clicked!");\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["This script is simple: it registers a publisher on ",(0,s.jsx)(n.code,{children:"Start()"})," and has a single public method, ",(0,s.jsx)(n.code,{children:"PublishCommand()"}),", that sends a message."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Step 4: Linking the Button to the Script"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Select your Button in the Hierarchy."}),"\n",(0,s.jsxs)(n.li,{children:["In the Inspector, find the ",(0,s.jsx)(n.code,{children:"Button"})," component. At the bottom is an ",(0,s.jsx)(n.code,{children:"On Click ()"})," event handler list."]}),"\n",(0,s.jsxs)(n.li,{children:["Click the ",(0,s.jsx)(n.strong,{children:'"+"'})," icon to add a new event."]}),"\n",(0,s.jsxs)(n.li,{children:['Drag your "RosManager" ',(0,s.jsx)(n.code,{children:"GameObject"})," (the one with the ",(0,s.jsx)(n.code,{children:"UIController"})," script) from the Hierarchy into the ",(0,s.jsx)(n.code,{children:"None (Object)"})," field."]}),"\n",(0,s.jsxs)(n.li,{children:['Click the dropdown that says "No Function" and navigate to ',(0,s.jsx)(n.strong,{children:"UIController > PublishCommand()"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.img,{src:"https://docs.unity3d.com/uploads/Main/UI_Button_OnClick.png",alt:"Button OnClick Event"}),"\n",(0,s.jsx)(n.em,{children:"(Image credit: Unity Technologies)"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"To test it:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Run your ",(0,s.jsx)(n.code,{children:"ros_tcp_endpoint"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Press Play in Unity."}),"\n",(0,s.jsxs)(n.li,{children:["In a ROS 2 terminal, run ",(0,s.jsx)(n.code,{children:"ros2 topic echo /ui_commands"}),"."]}),"\n",(0,s.jsx)(n.li,{children:'Click the "Send Command" button in your Unity scene. You should see the message appear in your terminal.'}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"2-designing-an-interactive-scenario-pick-and-place",children:"2. Designing an Interactive Scenario: Pick and Place"}),"\n",(0,s.jsx)(n.p,{children:'A common robotics task is "pick and place." Let\'s outline how to set up a simple version in Unity. The goal is to have the robot pick up a cube when a ROS 2 command is received.'}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Scenario Components:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"A Robot"}),": Your imported humanoid or robotic arm, configured with ",(0,s.jsx)(n.code,{children:"ArticulationBody"})," components and a ",(0,s.jsx)(n.code,{children:"JointController"})," script that can receive joint position commands."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"A Target Object"}),': A simple cube that the robot will "pick up."']}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"A Trigger Script"}),': A script that detects when the robot\'s gripper is close to the cube and "attaches" it.']}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Step 1: Create the Target Object"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Create a cube (",(0,s.jsx)(n.strong,{children:"Hierarchy > 3D Object > Cube"}),")."]}),"\n",(0,s.jsx)(n.li,{children:"Position it in front of the robot, within reach."}),"\n",(0,s.jsxs)(n.li,{children:["Add a ",(0,s.jsx)(n.code,{children:"RigidBody"})," component to the cube (",(0,s.jsx)(n.strong,{children:"Inspector > Add Component > RigidBody"}),"). This allows it to be affected by physics."]}),"\n",(0,s.jsxs)(n.li,{children:["On the cube's ",(0,s.jsx)(n.code,{children:"Box Collider"})," component, check the ",(0,s.jsx)(n.strong,{children:"Is Trigger"})," box. This turns the collider into a trigger volume, which can detect other colliders entering it without causing a physical collision. This is perfect for detecting when the gripper is near."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Step 2: Create the Gripper Detector"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["On your robot model, identify the gripper link (e.g., ",(0,s.jsx)(n.code,{children:"left_gripper_link"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:["Add a ",(0,s.jsx)(n.code,{children:"Box Collider"})," to this link and adjust its size to represent the gripping area. Make sure ",(0,s.jsx)(n.strong,{children:"Is Trigger"})," is ",(0,s.jsx)(n.strong,{children:"NOT"})," checked for this one. We want it to be a physical object."]}),"\n",(0,s.jsxs)(n.li,{children:["Add a ",(0,s.jsx)(n.code,{children:"RigidBody"})," to the gripper link as well. Set it to be ",(0,s.jsx)(n.strong,{children:"Is Kinematic"}),". This means it won't be affected by physics forces, but it can still register collision events with other objects."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Step 3: The Interaction Script"})}),"\n",(0,s.jsxs)(n.p,{children:["Create a C# script called ",(0,s.jsx)(n.code,{children:"PickAndPlace.cs"})," and attach it to the target cube."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'using UnityEngine;\nusing Unity.Robotics.ROSTCPConnector;\nusing RosMessageTypes.Std;\n\npublic class PickAndPlace : MonoBehaviour\n{\n    private ROSConnection ros;\n    private bool isGripping = false;\n    private GameObject gripper;\n\n    void Start()\n    {\n        ros = ROSConnection.GetOrCreateInstance();\n        ros.Subscribe<BoolMsg>("/gripper/command", GripperStateChange);\n    }\n\n    // Callback for ROS 2 gripper command\n    void GripperStateChange(BoolMsg message)\n    {\n        isGripping = message.data;\n        Debug.Log($"Gripper state set to: {isGripping}");\n\n        if (!isGripping && gripper != null)\n        {\n            // Detach the object\n            transform.SetParent(null); // Unparent\n            GetComponent<Rigidbody>().isKinematic = false; // Re-enable physics\n            gripper = null;\n        }\n    }\n\n    // This function is called when another collider enters this object\'s trigger\n    void OnTriggerStay(Collider other)\n    {\n        // Check if the gripper is commanded to close and we are near the gripper\n        if (isGripping && other.CompareTag("Gripper"))\n        {\n            // "Pick up" the object\n            gripper = other.gameObject;\n            transform.SetParent(gripper.transform); // Attach this cube to the gripper\n            GetComponent<Rigidbody>().isKinematic = true; // Disable physics\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"What this script does:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["It subscribes to a ",(0,s.jsx)(n.code,{children:"/gripper/command"})," topic, which we assume will be a ",(0,s.jsx)(n.code,{children:"std_msgs/Bool"})," message (",(0,s.jsx)(n.code,{children:"true"})," to grip, ",(0,s.jsx)(n.code,{children:"false"})," to release)."]}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"OnTriggerStay"})," function is a built-in Unity event. It's called every frame that another collider is inside this object's trigger volume."]}),"\n",(0,s.jsxs)(n.li,{children:['We check if the other collider has a "Gripper" tag (you should add this tag to your gripper ',(0,s.jsx)(n.code,{children:"GameObject"})," in the Inspector)."]}),"\n",(0,s.jsxs)(n.li,{children:["If the gripper is present and the ",(0,s.jsx)(n.code,{children:"isGripping"}),' flag is true, we "pick up" the cube by ',(0,s.jsx)(n.strong,{children:"parenting"})," its transform to the gripper's transform. This makes the cube move along with the gripper. We also set its ",(0,s.jsx)(n.code,{children:"RigidBody"})," to be kinematic to prevent it from falling."]}),"\n",(0,s.jsxs)(n.li,{children:["When the ",(0,s.jsx)(n.code,{children:"isGripping"})," flag is set to false, we detach the cube by un-parenting it and re-enabling its physics."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"To test this scenario:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Move your robot arm so the gripper's collider is intersecting the cube's trigger volume."}),"\n",(0,s.jsxs)(n.li,{children:["Publish a message to command the gripper to close:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'ros2 topic pub --once /gripper/command std_msgs/msg/Bool "{data: true}"\n'})}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"The cube should now be parented to the gripper. Move the arm around, and the cube will follow."}),"\n",(0,s.jsxs)(n.li,{children:["Publish a message to command the gripper to open:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'ros2 topic pub --once /gripper/command std_msgs/msg/Bool "{data: false}"\n'})}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"The cube should detach and fall."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"This simple example demonstrates the power of combining Unity's physics and scripting events with ROS 2 communication to build complex, interactive tests for your robot's software stack."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>c});var t=i(6540);const s={},r=t.createContext(s);function o(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);