"use strict";(globalThis.webpackChunkphysical_ai_course=globalThis.webpackChunkphysical_ai_course||[]).push([[6746],{1911:(e,r,a)=>{a.r(r),a.d(r,{assets:()=>o,contentTitle:()=>i,default:()=>m,frontMatter:()=>t,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"module-1-ros2/ch2-python-rclpy/parameters","title":"ROS 2 Parameters","description":"Introduction","source":"@site/docs/module-1-ros2/ch2-python-rclpy/parameters.md","sourceDirName":"module-1-ros2/ch2-python-rclpy","slug":"/module-1-ros2/ch2-python-rclpy/parameters","permalink":"/physical-ai-humanoid-robotics/docs/module-1-ros2/ch2-python-rclpy/parameters","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module-1-ros2/ch2-python-rclpy/parameters.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Timers and Callbacks in ROS 2","permalink":"/physical-ai-humanoid-robotics/docs/module-1-ros2/ch2-python-rclpy/timers-callbacks"},"next":{"title":"URDF Syntax and Robot Modeling","permalink":"/physical-ai-humanoid-robotics/docs/module-1-ros2/ch3-urdf/urdf-syntax"}}');var l=a(4848),s=a(8453);const t={},i="ROS 2 Parameters",o={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Why Parameters?",id:"why-parameters",level:2},{value:"Declaring Parameters",id:"declaring-parameters",level:2},{value:"Basic Parameter Declaration",id:"basic-parameter-declaration",level:3},{value:"One-Line Declaration and Retrieval",id:"one-line-declaration-and-retrieval",level:3},{value:"Parameter Types",id:"parameter-types",level:2},{value:"Example with Different Types",id:"example-with-different-types",level:3},{value:"Setting Parameters from Command Line",id:"setting-parameters-from-command-line",level:2},{value:"Using ros2 run",id:"using-ros2-run",level:3},{value:"Using ros2 param",id:"using-ros2-param",level:3},{value:"Loading Parameters from YAML Files",id:"loading-parameters-from-yaml-files",level:2},{value:"Creating a YAML Parameter File",id:"creating-a-yaml-parameter-file",level:3},{value:"Loading in Launch File",id:"loading-in-launch-file",level:3},{value:"Loading from Command Line",id:"loading-from-command-line",level:3},{value:"Parameter Callbacks (Dynamic Reconfiguration)",id:"parameter-callbacks-dynamic-reconfiguration",level:2},{value:"Practical Example: Configurable Robot Controller",id:"practical-example-configurable-robot-controller",level:2},{value:"Parameter File for Robot Controller",id:"parameter-file-for-robot-controller",level:3},{value:"Parameter Best Practices",id:"parameter-best-practices",level:2},{value:"1. Provide Sensible Defaults",id:"1-provide-sensible-defaults",level:3},{value:"2. Use Descriptive Names",id:"2-use-descriptive-names",level:3},{value:"3. Add Parameter Descriptors",id:"3-add-parameter-descriptors",level:3},{value:"4. Validate Parameter Values",id:"4-validate-parameter-values",level:3},{value:"5. Group Related Parameters",id:"5-group-related-parameters",level:3},{value:"Hands-On Exercise",id:"hands-on-exercise",level:2},{value:"Exercise 1: Configurable Publisher",id:"exercise-1-configurable-publisher",level:3},{value:"Exercise 2: Robot Configuration",id:"exercise-2-robot-configuration",level:3},{value:"Summary",id:"summary",level:2},{value:"Next Steps",id:"next-steps",level:2},{value:"Additional Resources",id:"additional-resources",level:2}];function c(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.header,{children:(0,l.jsx)(r.h1,{id:"ros-2-parameters",children:"ROS 2 Parameters"})}),"\n",(0,l.jsx)(r.h2,{id:"introduction",children:"Introduction"}),"\n",(0,l.jsx)(r.p,{children:"Parameters allow you to configure ROS 2 nodes at runtime without changing code. They enable flexibility and reusability, letting you tune behavior, adjust settings, and switch between different configurations. This lesson covers how to declare, use, and modify parameters in your nodes."}),"\n",(0,l.jsx)(r.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,l.jsx)(r.p,{children:"By the end of this lesson, you will be able to:"}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsx)(r.li,{children:"Declare and use parameters in ROS 2 nodes"}),"\n",(0,l.jsx)(r.li,{children:"Get and set parameter values from Python code"}),"\n",(0,l.jsx)(r.li,{children:"Modify parameters using command-line tools"}),"\n",(0,l.jsx)(r.li,{children:"Load parameters from YAML files"}),"\n",(0,l.jsx)(r.li,{children:"Implement parameter callbacks for dynamic reconfiguration"}),"\n",(0,l.jsx)(r.li,{children:"Use parameters for robot configuration"}),"\n"]}),"\n",(0,l.jsx)(r.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsx)(r.li,{children:"Understanding of ROS 2 nodes and topics"}),"\n",(0,l.jsx)(r.li,{children:"Completed previous Python/rclpy lessons"}),"\n",(0,l.jsx)(r.li,{children:"Basic Python knowledge"}),"\n"]}),"\n",(0,l.jsx)(r.hr,{}),"\n",(0,l.jsx)(r.h2,{id:"why-parameters",children:"Why Parameters?"}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.strong,{children:"Without Parameters:"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-python",children:'# Hardcoded values - requires code change\nPUBLISH_RATE = 10.0\nROBOT_NAME = "atlas"\nMAX_SPEED = 1.5\n'})}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.strong,{children:"With Parameters:"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-python",children:"# Configurable at runtime\nself.publish_rate = self.declare_parameter('publish_rate', 10.0).value\nself.robot_name = self.declare_parameter('robot_name', 'atlas').value\nself.max_speed = self.declare_parameter('max_speed', 1.5).value\n"})}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.strong,{children:"Benefits:"})}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsx)(r.li,{children:"Change behavior without recompiling"}),"\n",(0,l.jsx)(r.li,{children:"Reuse same node with different configurations"}),"\n",(0,l.jsx)(r.li,{children:"Tune parameters during development"}),"\n",(0,l.jsx)(r.li,{children:"Store configurations in files"}),"\n",(0,l.jsx)(r.li,{children:"Different settings for different robots/environments"}),"\n"]}),"\n",(0,l.jsx)(r.hr,{}),"\n",(0,l.jsx)(r.h2,{id:"declaring-parameters",children:"Declaring Parameters"}),"\n",(0,l.jsx)(r.h3,{id:"basic-parameter-declaration",children:"Basic Parameter Declaration"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\n\n\nclass ParameterNode(Node):\n    def __init__(self):\n        super().__init__('parameter_node')\n\n        # Declare parameters with default values\n        self.declare_parameter('robot_name', 'default_robot')\n        self.declare_parameter('publish_rate', 10.0)\n        self.declare_parameter('max_speed', 1.5)\n        self.declare_parameter('debug_mode', False)\n\n        # Get parameter values\n        self.robot_name = self.get_parameter('robot_name').value\n        self.publish_rate = self.get_parameter('publish_rate').value\n        self.max_speed = self.get_parameter('max_speed').value\n        self.debug_mode = self.get_parameter('debug_mode').value\n\n        # Use parameters\n        self.get_logger().info(f'Robot name: {self.robot_name}')\n        self.get_logger().info(f'Publish rate: {self.publish_rate} Hz')\n        self.get_logger().info(f'Max speed: {self.max_speed} m/s')\n        self.get_logger().info(f'Debug mode: {self.debug_mode}')\n\n        # Create timer with parameter-based rate\n        timer_period = 1.0 / self.publish_rate\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n\n    def timer_callback(self):\n        self.get_logger().info(f'{self.robot_name} timer callback')\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = ParameterNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,l.jsx)(r.h3,{id:"one-line-declaration-and-retrieval",children:"One-Line Declaration and Retrieval"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-python",children:"# Declare and get in one line\nself.robot_name = self.declare_parameter('robot_name', 'atlas').value\nself.max_speed = self.declare_parameter('max_speed', 1.5).value\n"})}),"\n",(0,l.jsx)(r.hr,{}),"\n",(0,l.jsx)(r.h2,{id:"parameter-types",children:"Parameter Types"}),"\n",(0,l.jsx)(r.p,{children:"ROS 2 supports several parameter types:"}),"\n",(0,l.jsxs)(r.table,{children:[(0,l.jsx)(r.thead,{children:(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.th,{children:"Type"}),(0,l.jsx)(r.th,{children:"Python Type"}),(0,l.jsx)(r.th,{children:"Example"})]})}),(0,l.jsxs)(r.tbody,{children:[(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:"Boolean"}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"bool"})}),(0,l.jsxs)(r.td,{children:[(0,l.jsx)(r.code,{children:"True"}),", ",(0,l.jsx)(r.code,{children:"False"})]})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:"Integer"}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"int"})}),(0,l.jsxs)(r.td,{children:[(0,l.jsx)(r.code,{children:"42"}),", ",(0,l.jsx)(r.code,{children:"-10"})]})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:"Double"}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"float"})}),(0,l.jsxs)(r.td,{children:[(0,l.jsx)(r.code,{children:"3.14"}),", ",(0,l.jsx)(r.code,{children:"1.5"})]})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:"String"}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"str"})}),(0,l.jsxs)(r.td,{children:[(0,l.jsx)(r.code,{children:'"hello"'}),", ",(0,l.jsx)(r.code,{children:'"robot_1"'})]})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:"Byte Array"}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"bytes"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"b'data'"})})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:"Boolean Array"}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"list[bool]"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"[True, False, True]"})})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:"Integer Array"}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"list[int]"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"[1, 2, 3, 4]"})})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:"Double Array"}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"list[float]"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"[1.0, 2.5, 3.7]"})})]}),(0,l.jsxs)(r.tr,{children:[(0,l.jsx)(r.td,{children:"String Array"}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:"list[str]"})}),(0,l.jsx)(r.td,{children:(0,l.jsx)(r.code,{children:'["a", "b", "c"]'})})]})]})]}),"\n",(0,l.jsx)(r.h3,{id:"example-with-different-types",children:"Example with Different Types"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-python",children:"class MultiTypeParameterNode(Node):\n    def __init__(self):\n        super().__init__('multi_type_parameter_node')\n\n        # Boolean\n        self.declare_parameter('enable_debug', False)\n\n        # Integer\n        self.declare_parameter('queue_size', 10)\n\n        # Double\n        self.declare_parameter('rate_hz', 10.0)\n\n        # String\n        self.declare_parameter('frame_id', 'base_link')\n\n        # Arrays\n        self.declare_parameter('joint_names', ['joint1', 'joint2', 'joint3'])\n        self.declare_parameter('joint_limits', [1.57, 3.14, 0.785])\n        self.declare_parameter('sensor_ids', [1, 2, 3, 4])\n\n        # Get values\n        self.enable_debug = self.get_parameter('enable_debug').value\n        self.queue_size = self.get_parameter('queue_size').value\n        self.rate_hz = self.get_parameter('rate_hz').value\n        self.frame_id = self.get_parameter('frame_id').value\n        self.joint_names = self.get_parameter('joint_names').value\n        self.joint_limits = self.get_parameter('joint_limits').value\n        self.sensor_ids = self.get_parameter('sensor_ids').value\n\n        # Log all parameters\n        self.log_parameters()\n\n    def log_parameters(self):\n        self.get_logger().info(f'Debug: {self.enable_debug}')\n        self.get_logger().info(f'Queue size: {self.queue_size}')\n        self.get_logger().info(f'Rate: {self.rate_hz} Hz')\n        self.get_logger().info(f'Frame ID: {self.frame_id}')\n        self.get_logger().info(f'Joint names: {self.joint_names}')\n        self.get_logger().info(f'Joint limits: {self.joint_limits}')\n        self.get_logger().info(f'Sensor IDs: {self.sensor_ids}')\n"})}),"\n",(0,l.jsx)(r.hr,{}),"\n",(0,l.jsx)(r.h2,{id:"setting-parameters-from-command-line",children:"Setting Parameters from Command Line"}),"\n",(0,l.jsx)(r.h3,{id:"using-ros2-run",children:"Using ros2 run"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-bash",children:"# Set single parameter\nros2 run my_package parameter_node --ros-args -p robot_name:=atlas\n\n# Set multiple parameters\nros2 run my_package parameter_node --ros-args \\\n    -p robot_name:=atlas \\\n    -p publish_rate:=5.0 \\\n    -p max_speed:=2.0 \\\n    -p debug_mode:=true\n"})}),"\n",(0,l.jsx)(r.h3,{id:"using-ros2-param",children:"Using ros2 param"}),"\n",(0,l.jsx)(r.p,{children:"While node is running:"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-bash",children:"# Get parameter value\nros2 param get /parameter_node robot_name\n\n# Set parameter value\nros2 param set /parameter_node publish_rate 20.0\n\n# List all parameters\nros2 param list /parameter_node\n\n# Describe parameter\nros2 param describe /parameter_node robot_name\n\n# Dump all parameters to file\nros2 param dump /parameter_node > node_params.yaml\n\n# Load parameters from file\nros2 param load /parameter_node node_params.yaml\n"})}),"\n",(0,l.jsx)(r.hr,{}),"\n",(0,l.jsx)(r.h2,{id:"loading-parameters-from-yaml-files",children:"Loading Parameters from YAML Files"}),"\n",(0,l.jsx)(r.h3,{id:"creating-a-yaml-parameter-file",children:"Creating a YAML Parameter File"}),"\n",(0,l.jsxs)(r.p,{children:["Create ",(0,l.jsx)(r.code,{children:"params.yaml"}),":"]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-yaml",children:'parameter_node:\n  ros__parameters:\n    robot_name: "atlas_v2"\n    publish_rate: 15.0\n    max_speed: 2.5\n    debug_mode: true\n    joint_names: ["shoulder", "elbow", "wrist"]\n    joint_limits: [1.57, 3.14, 0.785]\n'})}),"\n",(0,l.jsx)(r.h3,{id:"loading-in-launch-file",children:"Loading in Launch File"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-python",children:"from launch import LaunchDescription\nfrom launch_ros.actions import Node\nimport os\nfrom ament_index_python.packages import get_package_share_directory\n\n\ndef generate_launch_description():\n    # Get path to parameter file\n    params_file = os.path.join(\n        get_package_share_directory('my_package'),\n        'config',\n        'params.yaml'\n    )\n\n    return LaunchDescription([\n        Node(\n            package='my_package',\n            executable='parameter_node',\n            name='parameter_node',\n            parameters=[params_file]\n        )\n    ])\n"})}),"\n",(0,l.jsx)(r.h3,{id:"loading-from-command-line",children:"Loading from Command Line"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-bash",children:"ros2 run my_package parameter_node --ros-args --params-file params.yaml\n"})}),"\n",(0,l.jsx)(r.hr,{}),"\n",(0,l.jsx)(r.h2,{id:"parameter-callbacks-dynamic-reconfiguration",children:"Parameter Callbacks (Dynamic Reconfiguration)"}),"\n",(0,l.jsx)(r.p,{children:"Monitor and respond to parameter changes:"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-python",children:"from rcl_interfaces.msg import ParameterDescriptor, SetParametersResult\n\n\nclass DynamicParameterNode(Node):\n    def __init__(self):\n        super().__init__('dynamic_parameter_node')\n\n        # Declare parameters with descriptors\n        speed_descriptor = ParameterDescriptor(\n            description='Maximum robot speed in m/s',\n            additional_constraints='Must be between 0.0 and 5.0'\n        )\n\n        self.declare_parameter('max_speed', 1.5, speed_descriptor)\n        self.declare_parameter('robot_name', 'atlas')\n\n        # Add callback for parameter changes\n        self.add_on_set_parameters_callback(self.parameters_callback)\n\n        self.max_speed = self.get_parameter('max_speed').value\n        self.robot_name = self.get_parameter('robot_name').value\n\n        self.timer = self.create_timer(1.0, self.timer_callback)\n\n    def parameters_callback(self, params):\n        \"\"\"Called when parameters are changed\"\"\"\n        result = SetParametersResult(successful=True)\n\n        for param in params:\n            if param.name == 'max_speed':\n                if 0.0 <= param.value <= 5.0:\n                    self.max_speed = param.value\n                    self.get_logger().info(f'Max speed updated to: {self.max_speed}')\n                else:\n                    result.successful = False\n                    result.reason = 'max_speed must be between 0.0 and 5.0'\n\n            elif param.name == 'robot_name':\n                self.robot_name = param.value\n                self.get_logger().info(f'Robot name updated to: {self.robot_name}')\n\n        return result\n\n    def timer_callback(self):\n        self.get_logger().info(\n            f'Robot: {self.robot_name}, Max Speed: {self.max_speed} m/s'\n        )\n"})}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.strong,{children:"Testing Dynamic Parameters:"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-bash",children:'# Terminal 1: Run node\nros2 run my_package dynamic_parameter_node\n\n# Terminal 2: Change parameters\nros2 param set /dynamic_parameter_node max_speed 3.0\n# Success! Logs show: "Max speed updated to: 3.0"\n\nros2 param set /dynamic_parameter_node max_speed 10.0\n# Rejected! "max_speed must be between 0.0 and 5.0"\n'})}),"\n",(0,l.jsx)(r.hr,{}),"\n",(0,l.jsx)(r.h2,{id:"practical-example-configurable-robot-controller",children:"Practical Example: Configurable Robot Controller"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom geometry_msgs.msg import Twist\nfrom std_msgs.msg import Float32\nfrom rcl_interfaces.msg import ParameterDescriptor, SetParametersResult\n\n\nclass ConfigurableRobotController(Node):\n    def __init__(self):\n        super().__init__('configurable_robot_controller')\n\n        # Declare parameters with descriptors\n        self.declare_parameter(\n            'max_linear_speed',\n            1.0,\n            ParameterDescriptor(description='Max linear speed (m/s)')\n        )\n        self.declare_parameter(\n            'max_angular_speed',\n            1.57,\n            ParameterDescriptor(description='Max angular speed (rad/s)')\n        )\n        self.declare_parameter(\n            'control_rate',\n            10.0,\n            ParameterDescriptor(description='Control loop rate (Hz)')\n        )\n        self.declare_parameter(\n            'enable_safety_limits',\n            True,\n            ParameterDescriptor(description='Enable velocity safety limits')\n        )\n\n        # Get initial parameter values\n        self.update_parameters()\n\n        # Setup callback for parameter changes\n        self.add_on_set_parameters_callback(self.parameters_callback)\n\n        # Create publishers and subscribers\n        self.cmd_vel_pub = self.create_publisher(Twist, 'cmd_vel', 10)\n        self.battery_sub = self.create_subscription(\n            Float32,\n            'battery_voltage',\n            self.battery_callback,\n            10\n        )\n\n        # Create control timer based on control_rate parameter\n        timer_period = 1.0 / self.control_rate\n        self.timer = self.create_timer(timer_period, self.control_loop)\n\n        self.battery_voltage = 24.0\n        self.target_linear = 0.0\n        self.target_angular = 0.0\n\n        self.get_logger().info('Configurable Robot Controller initialized')\n        self.log_configuration()\n\n    def update_parameters(self):\n        \"\"\"Get current parameter values\"\"\"\n        self.max_linear_speed = self.get_parameter('max_linear_speed').value\n        self.max_angular_speed = self.get_parameter('max_angular_speed').value\n        self.control_rate = self.get_parameter('control_rate').value\n        self.enable_safety_limits = self.get_parameter('enable_safety_limits').value\n\n    def parameters_callback(self, params):\n        \"\"\"Handle parameter changes\"\"\"\n        result = SetParametersResult(successful=True)\n\n        for param in params:\n            if param.name == 'max_linear_speed':\n                if param.value > 0.0:\n                    self.max_linear_speed = param.value\n                else:\n                    result.successful = False\n                    result.reason = 'max_linear_speed must be positive'\n\n            elif param.name == 'max_angular_speed':\n                if param.value > 0.0:\n                    self.max_angular_speed = param.value\n                else:\n                    result.successful = False\n                    result.reason = 'max_angular_speed must be positive'\n\n            elif param.name == 'control_rate':\n                if param.value > 0.0:\n                    self.control_rate = param.value\n                    # Recreate timer with new rate\n                    self.timer.cancel()\n                    timer_period = 1.0 / self.control_rate\n                    self.timer = self.create_timer(timer_period, self.control_loop)\n                else:\n                    result.successful = False\n                    result.reason = 'control_rate must be positive'\n\n            elif param.name == 'enable_safety_limits':\n                self.enable_safety_limits = param.value\n\n        if result.successful:\n            self.log_configuration()\n\n        return result\n\n    def battery_callback(self, msg):\n        \"\"\"Monitor battery voltage\"\"\"\n        self.battery_voltage = msg.data\n\n    def control_loop(self):\n        \"\"\"Main control loop\"\"\"\n        cmd = Twist()\n\n        # Get desired velocities (from some control algorithm)\n        desired_linear = self.compute_desired_linear_velocity()\n        desired_angular = self.compute_desired_angular_velocity()\n\n        # Apply safety limits if enabled\n        if self.enable_safety_limits:\n            cmd.linear.x = self.clamp(\n                desired_linear,\n                -self.max_linear_speed,\n                self.max_linear_speed\n            )\n            cmd.angular.z = self.clamp(\n                desired_angular,\n                -self.max_angular_speed,\n                self.max_angular_speed\n            )\n\n            # Reduce speed if battery is low\n            if self.battery_voltage < 20.0:\n                cmd.linear.x *= 0.5\n                cmd.angular.z *= 0.5\n                self.get_logger().warn('Low battery! Reducing speed.')\n        else:\n            cmd.linear.x = desired_linear\n            cmd.angular.z = desired_angular\n\n        self.cmd_vel_pub.publish(cmd)\n\n    def compute_desired_linear_velocity(self):\n        \"\"\"Placeholder for actual control logic\"\"\"\n        return 0.5\n\n    def compute_desired_angular_velocity(self):\n        \"\"\"Placeholder for actual control logic\"\"\"\n        return 0.0\n\n    def clamp(self, value, min_val, max_val):\n        \"\"\"Clamp value between min and max\"\"\"\n        return max(min_val, min(value, max_val))\n\n    def log_configuration(self):\n        \"\"\"Log current configuration\"\"\"\n        self.get_logger().info('=== Configuration ===')\n        self.get_logger().info(f'Max Linear Speed: {self.max_linear_speed} m/s')\n        self.get_logger().info(f'Max Angular Speed: {self.max_angular_speed} rad/s')\n        self.get_logger().info(f'Control Rate: {self.control_rate} Hz')\n        self.get_logger().info(f'Safety Limits: {self.enable_safety_limits}')\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    controller = ConfigurableRobotController()\n    rclpy.spin(controller)\n    controller.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,l.jsx)(r.h3,{id:"parameter-file-for-robot-controller",children:"Parameter File for Robot Controller"}),"\n",(0,l.jsxs)(r.p,{children:[(0,l.jsx)(r.code,{children:"robot_config.yaml"}),":"]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-yaml",children:"configurable_robot_controller:\n  ros__parameters:\n    max_linear_speed: 2.0\n    max_angular_speed: 2.0\n    control_rate: 20.0\n    enable_safety_limits: true\n"})}),"\n",(0,l.jsx)(r.hr,{}),"\n",(0,l.jsx)(r.h2,{id:"parameter-best-practices",children:"Parameter Best Practices"}),"\n",(0,l.jsx)(r.h3,{id:"1-provide-sensible-defaults",children:"1. Provide Sensible Defaults"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-python",children:"# Good: Reasonable defaults\nself.declare_parameter('timeout', 5.0)\nself.declare_parameter('retry_count', 3)\n\n# Avoid: No context for defaults\nself.declare_parameter('value', 0)\n"})}),"\n",(0,l.jsx)(r.h3,{id:"2-use-descriptive-names",children:"2. Use Descriptive Names"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-python",children:"# Good\nself.declare_parameter('max_velocity_mps', 1.5)\nself.declare_parameter('battery_warning_threshold_volts', 20.0)\n\n# Avoid\nself.declare_parameter('vel', 1.5)\nself.declare_parameter('thresh', 20.0)\n"})}),"\n",(0,l.jsx)(r.h3,{id:"3-add-parameter-descriptors",children:"3. Add Parameter Descriptors"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-python",children:"descriptor = ParameterDescriptor(\n    description='Maximum velocity in meters per second',\n    additional_constraints='Range: 0.0 to 5.0',\n    read_only=False\n)\nself.declare_parameter('max_velocity', 1.5, descriptor)\n"})}),"\n",(0,l.jsx)(r.h3,{id:"4-validate-parameter-values",children:"4. Validate Parameter Values"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-python",children:"def parameters_callback(self, params):\n    result = SetParametersResult(successful=True)\n\n    for param in params:\n        if param.name == 'temperature_limit':\n            if not (0.0 <= param.value <= 100.0):\n                result.successful = False\n                result.reason = 'temperature_limit must be 0-100'\n\n    return result\n"})}),"\n",(0,l.jsx)(r.h3,{id:"5-group-related-parameters",children:"5. Group Related Parameters"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-yaml",children:"robot_controller:\n  ros__parameters:\n    # Motion parameters\n    max_linear_velocity: 1.5\n    max_angular_velocity: 2.0\n    acceleration_limit: 0.5\n\n    # Safety parameters\n    enable_collision_avoidance: true\n    safety_distance: 0.5\n\n    # Communication parameters\n    publish_rate: 10.0\n    queue_size: 10\n"})}),"\n",(0,l.jsx)(r.hr,{}),"\n",(0,l.jsx)(r.h2,{id:"hands-on-exercise",children:"Hands-On Exercise"}),"\n",(0,l.jsx)(r.h3,{id:"exercise-1-configurable-publisher",children:"Exercise 1: Configurable Publisher"}),"\n",(0,l.jsx)(r.p,{children:"Create a node that:"}),"\n",(0,l.jsxs)(r.ol,{children:["\n",(0,l.jsx)(r.li,{children:"Publishes messages at a configurable rate"}),"\n",(0,l.jsx)(r.li,{children:"Allows changing the message content via parameter"}),"\n",(0,l.jsx)(r.li,{children:"Can enable/disable publishing via boolean parameter"}),"\n"]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-python",children:"class ConfigurablePublisher(Node):\n    def __init__(self):\n        super().__init__('configurable_publisher')\n\n        # TODO: Declare parameters\n        # - publish_rate (float, default: 1.0)\n        # - message_prefix (string, default: \"Hello\")\n        # - enable_publishing (bool, default: True)\n\n        # TODO: Create publisher and timer\n\n        # TODO: Add parameter callback\n\n    def timer_callback(self):\n        # TODO: Publish only if enabled\n        pass\n\n    def parameters_callback(self, params):\n        # TODO: Handle parameter changes\n        pass\n"})}),"\n",(0,l.jsx)(r.h3,{id:"exercise-2-robot-configuration",children:"Exercise 2: Robot Configuration"}),"\n",(0,l.jsx)(r.p,{children:"Create a configuration file for a humanoid robot with:"}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsx)(r.li,{children:"Joint position limits (arrays)"}),"\n",(0,l.jsx)(r.li,{children:"Control rates for different systems"}),"\n",(0,l.jsx)(r.li,{children:"Safety thresholds"}),"\n",(0,l.jsx)(r.li,{children:"Debug flags"}),"\n"]}),"\n",(0,l.jsx)(r.hr,{}),"\n",(0,l.jsx)(r.h2,{id:"summary",children:"Summary"}),"\n",(0,l.jsx)(r.p,{children:"You've learned to:"}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsx)(r.li,{children:"Declare and use parameters in nodes"}),"\n",(0,l.jsx)(r.li,{children:"Load parameters from YAML files"}),"\n",(0,l.jsx)(r.li,{children:"Modify parameters at runtime"}),"\n",(0,l.jsx)(r.li,{children:"Implement parameter validation"}),"\n",(0,l.jsx)(r.li,{children:"Use parameters for robot configuration"}),"\n"]}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.strong,{children:"Key Takeaways:"})}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsx)(r.li,{children:"Parameters enable runtime configuration"}),"\n",(0,l.jsx)(r.li,{children:"Use descriptive names and provide defaults"}),"\n",(0,l.jsx)(r.li,{children:"Validate parameter changes with callbacks"}),"\n",(0,l.jsx)(r.li,{children:"Store configurations in YAML files"}),"\n",(0,l.jsx)(r.li,{children:"Parameters make nodes reusable"}),"\n"]}),"\n",(0,l.jsx)(r.hr,{}),"\n",(0,l.jsx)(r.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsxs)(r.li,{children:[(0,l.jsx)(r.a,{href:"/physical-ai-humanoid-robotics/docs/module-1-ros2/ch3-urdf/urdf-syntax",children:"URDF Syntax"})," - Model robots with URDF"]}),"\n",(0,l.jsxs)(r.li,{children:[(0,l.jsx)(r.a,{href:"/physical-ai-humanoid-robotics/docs/module-1-ros2/ch4-packages/workspace-setup",children:"Workspace Setup"})," - Create ROS 2 packages"]}),"\n",(0,l.jsxs)(r.li,{children:[(0,l.jsx)(r.a,{href:"/physical-ai-humanoid-robotics/docs/module-1-ros2/ch4-packages/launch-files",children:"Launch Files"})," - Launch with parameters"]}),"\n"]}),"\n",(0,l.jsx)(r.hr,{}),"\n",(0,l.jsx)(r.h2,{id:"additional-resources",children:"Additional Resources"}),"\n",(0,l.jsxs)(r.ul,{children:["\n",(0,l.jsx)(r.li,{children:(0,l.jsx)(r.a,{href:"https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Using-Parameters-In-A-Class-Python.html",children:"ROS 2 Parameters Tutorial"})}),"\n",(0,l.jsx)(r.li,{children:(0,l.jsx)(r.a,{href:"https://docs.ros.org/en/humble/How-To-Guides/Node-arguments.html",children:"Parameter YAML Format"})}),"\n",(0,l.jsx)(r.li,{children:(0,l.jsx)(r.a,{href:"https://docs.ros2.org/latest/api/rcl_interfaces/msg/ParameterDescriptor.html",children:"rcl_interfaces/msg/ParameterDescriptor"})}),"\n"]})]})}function m(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,l.jsx)(r,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},8453:(e,r,a)=>{a.d(r,{R:()=>t,x:()=>i});var n=a(6540);const l={},s=n.createContext(l);function t(e){const r=n.useContext(s);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),n.createElement(s.Provider,{value:r},e.children)}}}]);