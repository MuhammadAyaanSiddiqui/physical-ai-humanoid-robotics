"use strict";(globalThis.webpackChunkphysical_ai_course=globalThis.webpackChunkphysical_ai_course||[]).push([[7211],{988:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"module-2-simulation/ch6-unity/importing-models","title":"Importing and Configuring Robot Models in Unity","description":"Once you have the Unity Robotics Hub installed, you can bring your robot models to life inside the Unity editor. The URDF Importer package is the magic that converts a standard URDF file into a game object that Unity can understand, complete with articulated joints and collision meshes.","source":"@site/docs/module-2-simulation/ch6-unity/importing-models.md","sourceDirName":"module-2-simulation/ch6-unity","slug":"/module-2-simulation/ch6-unity/importing-models","permalink":"/physical-ai-humanoid-robotics/docs/module-2-simulation/ch6-unity/importing-models","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module-2-simulation/ch6-unity/importing-models.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Getting Started with Unity and the Robotics Hub","permalink":"/physical-ai-humanoid-robotics/docs/module-2-simulation/ch6-unity/unity-robotics-hub"},"next":{"title":"Unity to ROS 2 Communication with the TCP Connector","permalink":"/physical-ai-humanoid-robotics/docs/module-2-simulation/ch6-unity/tcp-ros2-comm"}}');var o=i(4848),s=i(8453);const r={},c="Importing and Configuring Robot Models in Unity",l={},d=[{value:"Step 1: Importing a URDF",id:"step-1-importing-a-urdf",level:2},{value:"Step 2: Examining the Imported Robot",id:"step-2-examining-the-imported-robot",level:2},{value:"Understanding Articulation Bodies",id:"understanding-articulation-bodies",level:3},{value:"Step 3: Configuring the Joints",id:"step-3-configuring-the-joints",level:2},{value:"Step 4: Adding Controllers",id:"step-4-adding-controllers",level:2}];function a(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"importing-and-configuring-robot-models-in-unity",children:"Importing and Configuring Robot Models in Unity"})}),"\n",(0,o.jsxs)(n.p,{children:["Once you have the Unity Robotics Hub installed, you can bring your robot models to life inside the Unity editor. The ",(0,o.jsx)(n.code,{children:"URDF Importer"})," package is the magic that converts a standard URDF file into a game object that Unity can understand, complete with articulated joints and collision meshes."]}),"\n",(0,o.jsx)(n.h2,{id:"step-1-importing-a-urdf",children:"Step 1: Importing a URDF"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Locate Your URDF"}),": Have your robot's URDF file and its associated mesh files ready. It's best practice to have the meshes in a sub-folder relative to the URDF (e.g., ",(0,o.jsx)(n.code,{children:"meshes/"}),")."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Import into Unity"}),":"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["In the Unity Editor, navigate to the ",(0,o.jsx)(n.strong,{children:"Assets"})," window."]}),"\n",(0,o.jsxs)(n.li,{children:["Right-click and select ",(0,o.jsx)(n.strong,{children:"Import Robot from URDF"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["A file dialog will open. Select your ",(0,o.jsx)(n.code,{children:".urdf"})," file."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Configure the Importer"}),": An import settings window will appear."]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Axis Type"}),": Set this to ",(0,o.jsx)(n.strong,{children:"Z up"})," (the standard for ROS). Unity's native coordinate system is Y up, so this correctly rotates the model on import."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Mesh Decomposer"}),": Keep this on the default setting (",(0,o.jsx)(n.code,{children:"VHACD"}),") which is good for generating collision meshes."]}),"\n",(0,o.jsxs)(n.li,{children:["Click ",(0,o.jsx)(n.strong,{children:"Import"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Unity will now process the URDF file, read the links and joints, and create a ",(0,o.jsx)(n.strong,{children:"prefab"}),". A prefab is a reusable game object that contains all the components, properties, and child objects that make up your robot."]}),"\n",(0,o.jsxs)(n.p,{children:["You will find the new prefab in your ",(0,o.jsx)(n.code,{children:"Assets"})," folder."]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.img,{src:"https://user-images.githubusercontent.com/25339203/110582823-ce2b4180-812e-11eb-8094-1a9a83ea7447.png",alt:"URDF Import Window"}),"\n",(0,o.jsx)(n.em,{children:"(Image credit: Unity Technologies)"})]}),"\n",(0,o.jsx)(n.h2,{id:"step-2-examining-the-imported-robot",children:"Step 2: Examining the Imported Robot"}),"\n",(0,o.jsxs)(n.p,{children:["Drag the newly created robot prefab from your ",(0,o.jsx)(n.code,{children:"Assets"})," folder into the ",(0,o.jsx)(n.strong,{children:"Hierarchy"})," window or directly into the ",(0,o.jsx)(n.strong,{children:"Scene"})," view."]}),"\n",(0,o.jsxs)(n.p,{children:["Now, select the robot in the Hierarchy. Look at the ",(0,o.jsx)(n.strong,{children:"Inspector"})," window. You will see several important components that have been automatically added:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"Articulation Body"})}),": This is the core physics component for robotics in Unity.","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["The ",(0,o.jsx)(n.strong,{children:"root link"})," of the robot (the one with no parent joint) will have a main ",(0,o.jsx)(n.code,{children:"Articulation Body"})," component."]}),"\n",(0,o.jsxs)(n.li,{children:["Every ",(0,o.jsx)(n.strong,{children:"child link"})," will also have an ",(0,o.jsx)(n.code,{children:"Articulation Body"})," component, configured to represent its joint connection to its parent."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"URDF Link"})}),": A script that holds information from the original URDF link, including its name."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"URDF Joint"})}),": A script attached to each child link that defines the joint type (",(0,o.jsx)(n.code,{children:"Revolute"}),", ",(0,o.jsx)(n.code,{children:"Prismatic"}),", ",(0,o.jsx)(n.code,{children:"Fixed"}),", etc.), motion limits, and other properties."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"understanding-articulation-bodies",children:"Understanding Articulation Bodies"}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"Articulation Body"})," component is what makes a multi-jointed robot behave correctly. Unlike standard ",(0,o.jsx)(n.code,{children:"RigidBody"})," physics in Unity, which is designed for stacking boxes and simple collisions, articulations are designed for the chain-like dependencies of a robot arm or leg."]}),"\n",(0,o.jsxs)(n.p,{children:["Key properties of an ",(0,o.jsx)(n.code,{children:"Articulation Body"})," on a joint:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Joint Type"}),": ",(0,o.jsx)(n.code,{children:"Revolute"}),", ",(0,o.jsx)(n.code,{children:"Prismatic"}),", etc."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Motion"}),": ",(0,o.jsx)(n.code,{children:"Locked"}),", ",(0,o.jsx)(n.code,{children:"Limited"}),", or ",(0,o.jsx)(n.code,{children:"Free"}),". For a revolute joint with limits, this would be ",(0,o.jsx)(n.code,{children:"Limited"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Lower and Upper Limits"}),": The joint's range of motion in degrees or meters."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Stiffness and Damping"}),': These parameters control the "springiness" of the joint motor. You can set a ',(0,o.jsx)(n.code,{children:"Target"})," position and use these values to drive the joint."]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.img,{src:"https://docs.unity3d.com/2022.3/Documentation/uploads/Main/Inspector-ArticulationBody.png",alt:"Articulation Body Component"}),"\n",(0,o.jsx)(n.em,{children:"(Image credit: Unity Technologies)"})]}),"\n",(0,o.jsx)(n.h2,{id:"step-3-configuring-the-joints",children:"Step 3: Configuring the Joints"}),"\n",(0,o.jsx)(n.p,{children:"The URDF importer does a good job, but you often need to fine-tune the joint settings."}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Select a Joint"}),": In the Hierarchy, expand the robot's object tree and select a link that has a joint (e.g., ",(0,o.jsx)(n.code,{children:"shoulder_link"}),")."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Inspect the Articulation Body"}),":","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Verify that the ",(0,o.jsx)(n.strong,{children:"Joint Type"})," is correct."]}),"\n",(0,o.jsxs)(n.li,{children:["Set the ",(0,o.jsx)(n.strong,{children:"Motion"})," to ",(0,o.jsx)(n.code,{children:"Limited"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["Enter the correct ",(0,o.jsx)(n.strong,{children:"Lower"})," and ",(0,o.jsx)(n.strong,{children:"Upper Limits"})," in degrees. These should match the safety limits of your physical robot."]}),"\n",(0,o.jsxs)(n.li,{children:["Add a small amount of ",(0,o.jsx)(n.strong,{children:"Damping"})," (e.g., 10-100) to improve stability and prevent uncontrolled oscillations."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"step-4-adding-controllers",children:"Step 4: Adding Controllers"}),"\n",(0,o.jsxs)(n.p,{children:["To make the robot move, you need to add a controller script that can interface with the ",(0,o.jsx)(n.code,{children:"Articulation Body"})," components and with ROS 2."]}),"\n",(0,o.jsxs)(n.p,{children:["The Robotics Hub provides a helpful script called ",(0,o.jsx)(n.code,{children:"AGVController"})," for simple wheeled robots, but for a humanoid, you'll typically write a custom script."]}),"\n",(0,o.jsx)(n.p,{children:"Let's look at the logic for a basic joint controller script."}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Create a C# Script"}),": In your ",(0,o.jsx)(n.code,{children:"Assets"})," folder, right-click, select ",(0,o.jsx)(n.strong,{children:"Create > C# Script"}),", and name it ",(0,o.jsx)(n.code,{children:"JointController"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Add the script to your robot"}),": Drag the script onto the root object of your robot prefab in the Hierarchy."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Edit the script"}),": Double-click the script to open it in Visual Studio or your code editor of choice."]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Here is a simplified example of a script that subscribes to a ROS 2 ",(0,o.jsx)(n.code,{children:"Float64MultiArray"})," topic for joint commands and applies them to the robot's joints."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:'using UnityEngine;\nusing Unity.Robotics.ROSTCPConnector;\nusing RosMessageTypes.Std;\n\npublic class JointController : MonoBehaviour\n{\n    // A dictionary to hold our joint objects\n    private System.Collections.Generic.Dictionary<string, ArticulationBody> jointArticulationBodies;\n\n    // ROS Connector\n    private ROSConnection ros;\n    \n    // Start is called before the first frame update\n    void Start()\n    {\n        // Get the ROS connection instance\n        ros = ROSConnection.GetOrCreateInstance();\n        \n        // Subscribe to the joint command topic\n        ros.Subscribe<Float64MultiArrayMsg>("/joint_commands", ReceiveJointCommands);\n\n        // --- Find and map all the joints ---\n        jointArticulationBodies = new System.Collections.Generic.Dictionary<string, ArticulationBody>();\n        \n        // Find all ArticulationBody components in the robot\n        ArticulationBody[] allJoints = GetComponentsInChildren<ArticulationBody>();\n        \n        foreach (ArticulationBody joint in allJoints)\n        {\n            // The root link has no parent, so we skip it\n            if (joint.isRoot) continue;\n            \n            // Get the URDFJoint script to find the original joint name\n            URDFJoint urdfJoint = joint.GetComponent<URDFJoint>();\n            if (urdfJoint != null)\n            {\n                jointArticulationBodies.Add(urdfJoint.jointName, joint);\n            }\n        }\n    }\n\n    // Callback function for when we receive a joint command message\n    void ReceiveJointCommands(Float64MultiArrayMsg message)\n    {\n        // Assuming the message data array is ordered correctly\n        // and matches the number of controllable joints.\n        \n        // A more robust implementation would include the joint names in the message.\n        int i = 0;\n        foreach (var joint in jointArticulationBodies)\n        {\n            if (i < message.data.Length)\n            {\n                // Get the target position from the message\n                float targetPosition = (float)message.data[i];\n                \n                // Get the ArticulationBody for this joint\n                ArticulationBody articulationBody = joint.Value;\n                \n                // Set the target for the joint\'s drive\n                var drive = articulationBody.xDrive;\n                drive.target = targetPosition;\n                articulationBody.xDrive = drive;\n            }\n            i++;\n        }\n    }\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"This script does the following:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["On ",(0,o.jsx)(n.code,{children:"Start"}),", it gets the ",(0,o.jsx)(n.code,{children:"ROSConnection"})," and subscribes to a topic named ",(0,o.jsx)(n.code,{children:"/joint_commands"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["It finds all ",(0,o.jsx)(n.code,{children:"ArticulationBody"})," components on the robot and stores them in a dictionary, mapped by their URDF joint name."]}),"\n",(0,o.jsxs)(n.li,{children:["When a message is received on ",(0,o.jsx)(n.code,{children:"/joint_commands"}),", the ",(0,o.jsx)(n.code,{children:"ReceiveJointCommands"})," function is called."]}),"\n",(0,o.jsxs)(n.li,{children:["It iterates through the message data and applies each value as a ",(0,o.jsx)(n.code,{children:"target"})," for the corresponding joint's ",(0,o.jsx)(n.code,{children:"xDrive"}),". The articulation body's internal physics motor will then work to move the joint to that target position."]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"By following these steps, you can successfully import any URDF-based robot, configure its physics properties, and add a basic ROS 2 controller to bring it to life in a stunning Unity environment."})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>c});var t=i(6540);const o={},s=t.createContext(o);function r(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);