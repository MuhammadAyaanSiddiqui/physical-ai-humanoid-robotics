"use strict";(globalThis.webpackChunkphysical_ai_course=globalThis.webpackChunkphysical_ai_course||[]).push([[3760],{1100:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/files/minimal_subscriber-f8af9d5bfabf50a06b34813b110c0c25.py"},2592:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/files/minimal_publisher-f81e14cec493d60dc10425ec3087f364.py"},7371:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"module-1-ros2/ch2-python-rclpy/first-node","title":"Your First ROS 2 Node in Python","description":"Introduction","source":"@site/docs/module-1-ros2/ch2-python-rclpy/first-node.md","sourceDirName":"module-1-ros2/ch2-python-rclpy","slug":"/module-1-ros2/ch2-python-rclpy/first-node","permalink":"/physical-ai-humanoid-robotics/docs/module-1-ros2/ch2-python-rclpy/first-node","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module-1-ros2/ch2-python-rclpy/first-node.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"ROS 2 CLI Tools","permalink":"/physical-ai-humanoid-robotics/docs/module-1-ros2/ch1-fundamentals/cli-tools"},"next":{"title":"ROS 2 Message Types","permalink":"/physical-ai-humanoid-robotics/docs/module-1-ros2/ch2-python-rclpy/message-types"}}');var r=s(4848),l=s(8453);const t={},a="Your First ROS 2 Node in Python",c={},o=[{value:"Introduction",id:"introduction",level:2},{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Understanding rclpy",id:"understanding-rclpy",level:2},{value:"Creating a Simple Publisher Node",id:"creating-a-simple-publisher-node",level:2},{value:"Step 1: Create the Python File",id:"step-1-create-the-python-file",level:3},{value:"Understanding the Code",id:"understanding-the-code",level:3},{value:"1. Imports",id:"1-imports",level:4},{value:"2. Node Class Definition",id:"2-node-class-definition",level:4},{value:"3. Creating a Publisher",id:"3-creating-a-publisher",level:4},{value:"4. Creating a Timer",id:"4-creating-a-timer",level:4},{value:"5. Timer Callback",id:"5-timer-callback",level:4},{value:"6. Main Function",id:"6-main-function",level:4},{value:"Creating a Simple Subscriber Node",id:"creating-a-simple-subscriber-node",level:2},{value:"Step 2: Create the Subscriber",id:"step-2-create-the-subscriber",level:3},{value:"Understanding the Subscriber",id:"understanding-the-subscriber",level:3},{value:"1. Creating a Subscription",id:"1-creating-a-subscription",level:4},{value:"2. Listener Callback",id:"2-listener-callback",level:4},{value:"Running Your Nodes",id:"running-your-nodes",level:2},{value:"Method 1: Direct Python Execution",id:"method-1-direct-python-execution",level:3},{value:"Method 2: Verify with ROS 2 CLI Tools",id:"method-2-verify-with-ros-2-cli-tools",level:3},{value:"Node Lifecycle",id:"node-lifecycle",level:2},{value:"The Spin Loop",id:"the-spin-loop",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Always Use Context Managers (Optional)",id:"1-always-use-context-managers-optional",level:3},{value:"2. Use Descriptive Node Names",id:"2-use-descriptive-node-names",level:3},{value:"3. Log Important Events",id:"3-log-important-events",level:3},{value:"4. Initialize All Attributes in <strong>init</strong>",id:"4-initialize-all-attributes-in-init",level:3},{value:"Common Patterns",id:"common-patterns",level:2},{value:"Pattern 1: Publish on Demand (No Timer)",id:"pattern-1-publish-on-demand-no-timer",level:3},{value:"Pattern 2: Subscriber That Republishes",id:"pattern-2-subscriber-that-republishes",level:3},{value:"Pattern 3: Multi-Subscriber Node",id:"pattern-3-multi-subscriber-node",level:3},{value:"Debugging Tips",id:"debugging-tips",level:2},{value:"Problem: Node Not Receiving Messages",id:"problem-node-not-receiving-messages",level:3},{value:"Problem: ImportError for Message Types",id:"problem-importerror-for-message-types",level:3},{value:"Problem: Node Exits Immediately",id:"problem-node-exits-immediately",level:3},{value:"Hands-On Exercise",id:"hands-on-exercise",level:2},{value:"Exercise 1: Temperature Monitor",id:"exercise-1-temperature-monitor",level:3},{value:"Exercise 2: Counter Node",id:"exercise-2-counter-node",level:3},{value:"Summary",id:"summary",level:2},{value:"Next Steps",id:"next-steps",level:2},{value:"Additional Resources",id:"additional-resources",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"your-first-ros-2-node-in-python",children:"Your First ROS 2 Node in Python"})}),"\n",(0,r.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsxs)(n.p,{children:["In this lesson, you'll create your first ROS 2 node using Python and the ",(0,r.jsx)(n.code,{children:"rclpy"})," library. You'll build a simple publisher node that sends messages to a topic, and a subscriber node that receives those messages. This hands-on experience will give you a solid foundation for building more complex robotic systems."]}),"\n",(0,r.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,r.jsx)(n.p,{children:"By the end of this lesson, you will be able to:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Create a basic ROS 2 publisher node in Python"}),"\n",(0,r.jsx)(n.li,{children:"Create a basic ROS 2 subscriber node in Python"}),"\n",(0,r.jsx)(n.li,{children:"Understand the structure of a ROS 2 Python node"}),"\n",(0,r.jsx)(n.li,{children:"Run and test your nodes using ROS 2 CLI tools"}),"\n",(0,r.jsx)(n.li,{children:"Understand the node lifecycle and initialization"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"ROS 2 Humble installed and sourced"}),"\n",(0,r.jsx)(n.li,{children:"Python 3.10+ installed"}),"\n",(0,r.jsx)(n.li,{children:"Basic Python programming knowledge"}),"\n",(0,r.jsx)(n.li,{children:"Understanding of ROS 2 concepts (nodes, topics, messages)"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"understanding-rclpy",children:"Understanding rclpy"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"rclpy"})," is the ROS 2 Python client library. It provides:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Node creation"}),": Base class for creating ROS 2 nodes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Communication"}),": Publishers, subscribers, services, actions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Utilities"}),": Logging, parameters, timers, and more"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"creating-a-simple-publisher-node",children:"Creating a Simple Publisher Node"}),"\n",(0,r.jsx)(n.h3,{id:"step-1-create-the-python-file",children:"Step 1: Create the Python File"}),"\n",(0,r.jsxs)(n.p,{children:["Create a file named ",(0,r.jsx)(n.code,{children:"minimal_publisher.py"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\n\nclass MinimalPublisher(Node):\n    def __init__(self):\n        # Initialize the node with a name\n        super().__init__('minimal_publisher')\n\n        # Create a publisher on the 'chatter' topic\n        # Queue size of 10 means it can hold 10 messages before dropping old ones\n        self.publisher_ = self.create_publisher(String, 'chatter', 10)\n\n        # Create a timer that calls the callback every 0.5 seconds\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n\n        # Counter for message numbering\n        self.i = 0\n\n        self.get_logger().info('Minimal Publisher has been started')\n\n    def timer_callback(self):\n        # Create a message\n        msg = String()\n        msg.data = f'Hello World: {self.i}'\n\n        # Publish the message\n        self.publisher_.publish(msg)\n\n        # Log the published message\n        self.get_logger().info(f'Publishing: \"{msg.data}\"')\n\n        # Increment counter\n        self.i += 1\n\n\ndef main(args=None):\n    # Initialize rclpy\n    rclpy.init(args=args)\n\n    # Create the node\n    minimal_publisher = MinimalPublisher()\n\n    # Keep the node running (spin)\n    # This blocks until the node is shut down (Ctrl+C)\n    rclpy.spin(minimal_publisher)\n\n    # Clean shutdown\n    minimal_publisher.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"understanding-the-code",children:"Understanding the Code"}),"\n",(0,r.jsx)(n.p,{children:"Let's break down each component:"}),"\n",(0,r.jsx)(n.h4,{id:"1-imports",children:"1. Imports"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"rclpy"}),": The ROS 2 Python client library"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Node"}),": Base class for all ROS 2 nodes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"String"}),": A standard message type for text data"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"2-node-class-definition",children:"2. Node Class Definition"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class MinimalPublisher(Node):\n    def __init__(self):\n        super().__init__('minimal_publisher')\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Inherit from the ",(0,r.jsx)(n.code,{children:"Node"})," base class"]}),"\n",(0,r.jsxs)(n.li,{children:["Call ",(0,r.jsx)(n.code,{children:"super().__init__()"})," with the node name"]}),"\n",(0,r.jsx)(n.li,{children:"The node name must be unique in the ROS 2 network"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"3-creating-a-publisher",children:"3. Creating a Publisher"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"self.publisher_ = self.create_publisher(String, 'chatter', 10)\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"First argument"}),": Message type (",(0,r.jsx)(n.code,{children:"String"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Second argument"}),": Topic name (",(0,r.jsx)(n.code,{children:"'chatter'"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Third argument"}),": Queue size (10 messages)"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"4-creating-a-timer",children:"4. Creating a Timer"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"self.timer = self.create_timer(timer_period, self.timer_callback)\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Calls ",(0,r.jsx)(n.code,{children:"timer_callback()"})," every ",(0,r.jsx)(n.code,{children:"timer_period"})," seconds"]}),"\n",(0,r.jsx)(n.li,{children:"Enables periodic publishing without blocking"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"5-timer-callback",children:"5. Timer Callback"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"def timer_callback(self):\n    msg = String()\n    msg.data = f'Hello World: {self.i}'\n    self.publisher_.publish(msg)\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Create a message instance"}),"\n",(0,r.jsx)(n.li,{children:"Set the message data"}),"\n",(0,r.jsx)(n.li,{children:"Publish the message"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"6-main-function",children:"6. Main Function"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"def main(args=None):\n    rclpy.init(args=args)\n    minimal_publisher = MinimalPublisher()\n    rclpy.spin(minimal_publisher)\n    minimal_publisher.destroy_node()\n    rclpy.shutdown()\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"rclpy.init()"})}),": Initialize the ROS 2 Python client library"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Create node"}),": Instantiate your node class"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"rclpy.spin()"})}),": Keep the node alive and process callbacks"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cleanup"}),": Destroy the node and shutdown rclpy"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"creating-a-simple-subscriber-node",children:"Creating a Simple Subscriber Node"}),"\n",(0,r.jsx)(n.h3,{id:"step-2-create-the-subscriber",children:"Step 2: Create the Subscriber"}),"\n",(0,r.jsxs)(n.p,{children:["Create a file named ",(0,r.jsx)(n.code,{children:"minimal_subscriber.py"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\n\nclass MinimalSubscriber(Node):\n    def __init__(self):\n        # Initialize the node with a name\n        super().__init__('minimal_subscriber')\n\n        # Create a subscription to the 'chatter' topic\n        self.subscription = self.create_subscription(\n            String,\n            'chatter',\n            self.listener_callback,\n            10\n        )\n        # Prevent unused variable warning\n        self.subscription\n\n        self.get_logger().info('Minimal Subscriber has been started')\n\n    def listener_callback(self, msg):\n        # This callback is executed when a message is received\n        self.get_logger().info(f'I heard: \"{msg.data}\"')\n\n\ndef main(args=None):\n    # Initialize rclpy\n    rclpy.init(args=args)\n\n    # Create the node\n    minimal_subscriber = MinimalSubscriber()\n\n    # Keep the node running\n    rclpy.spin(minimal_subscriber)\n\n    # Clean shutdown\n    minimal_subscriber.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"understanding-the-subscriber",children:"Understanding the Subscriber"}),"\n",(0,r.jsx)(n.h4,{id:"1-creating-a-subscription",children:"1. Creating a Subscription"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"self.subscription = self.create_subscription(\n    String,           # Message type\n    'chatter',        # Topic name\n    self.listener_callback,  # Callback function\n    10                # Queue size\n)\n"})}),"\n",(0,r.jsx)(n.h4,{id:"2-listener-callback",children:"2. Listener Callback"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"def listener_callback(self, msg):\n    self.get_logger().info(f'I heard: \"{msg.data}\"')\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Called automatically when a message arrives"}),"\n",(0,r.jsx)(n.li,{children:"Receives the message as a parameter"}),"\n",(0,r.jsxs)(n.li,{children:["Access message data via ",(0,r.jsx)(n.code,{children:"msg.data"})]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"running-your-nodes",children:"Running Your Nodes"}),"\n",(0,r.jsx)(n.h3,{id:"method-1-direct-python-execution",children:"Method 1: Direct Python Execution"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Terminal 1 - Run Publisher:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"source /opt/ros/humble/setup.bash\npython3 minimal_publisher.py\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Terminal 2 - Run Subscriber:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"source /opt/ros/humble/setup.bash\npython3 minimal_subscriber.py\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Expected Output (Publisher):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'[INFO] [minimal_publisher]: Minimal Publisher has been started\n[INFO] [minimal_publisher]: Publishing: "Hello World: 0"\n[INFO] [minimal_publisher]: Publishing: "Hello World: 1"\n[INFO] [minimal_publisher]: Publishing: "Hello World: 2"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Expected Output (Subscriber):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'[INFO] [minimal_subscriber]: Minimal Subscriber has been started\n[INFO] [minimal_subscriber]: I heard: "Hello World: 0"\n[INFO] [minimal_subscriber]: I heard: "Hello World: 1"\n[INFO] [minimal_subscriber]: I heard: "Hello World: 2"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"method-2-verify-with-ros-2-cli-tools",children:"Method 2: Verify with ROS 2 CLI Tools"}),"\n",(0,r.jsx)(n.p,{children:"While the nodes are running, open a third terminal:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# List active nodes\nros2 node list\n\n# List active topics\nros2 topic list\n\n# Echo messages\nros2 topic echo /chatter\n\n# Check publish rate\nros2 topic hz /chatter\n\n# Visualize the graph\nrqt_graph\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"node-lifecycle",children:"Node Lifecycle"}),"\n",(0,r.jsx)(n.p,{children:"Understanding the lifecycle of a ROS 2 node:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"1. rclpy.init()          \u2192 Initialize ROS 2\n2. Node.__init__()       \u2192 Create node\n3. create_publisher()    \u2192 Set up communication\n4. create_timer()        \u2192 Set up periodic tasks\n5. rclpy.spin()          \u2192 Enter event loop (process callbacks)\n6. destroy_node()        \u2192 Clean up node resources\n7. rclpy.shutdown()      \u2192 Shutdown ROS 2\n"})}),"\n",(0,r.jsx)(n.h3,{id:"the-spin-loop",children:"The Spin Loop"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"rclpy.spin(node)\n"})}),"\n",(0,r.jsx)(n.p,{children:"This function:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Blocks and waits for events (messages, timers, service calls)"}),"\n",(0,r.jsx)(n.li,{children:"Executes callbacks when events occur"}),"\n",(0,r.jsxs)(n.li,{children:["Continues until interrupted (Ctrl+C) or ",(0,r.jsx)(n.code,{children:"rclpy.shutdown()"})," is called"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"1-always-use-context-managers-optional",children:"1. Always Use Context Managers (Optional)"}),"\n",(0,r.jsx)(n.p,{children:"For more robust cleanup:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"def main(args=None):\n    rclpy.init(args=args)\n\n    try:\n        node = MinimalPublisher()\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-use-descriptive-node-names",children:"2. Use Descriptive Node Names"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Good\nsuper().__init__('robot_controller')\nsuper().__init__('camera_processor')\n\n# Avoid\nsuper().__init__('node1')\nsuper().__init__('my_node')\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-log-important-events",children:"3. Log Important Events"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"self.get_logger().info('Node started successfully')\nself.get_logger().warn('Low battery detected')\nself.get_logger().error('Failed to connect to sensor')\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"4-initialize-all-attributes-in-init",children:["4. Initialize All Attributes in ",(0,r.jsx)(n.strong,{children:"init"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"def __init__(self):\n    super().__init__('my_node')\n\n    # All initialization here\n    self.counter = 0\n    self.last_message_time = self.get_clock().now()\n    self.publisher_ = self.create_publisher(String, 'topic', 10)\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,r.jsx)(n.h3,{id:"pattern-1-publish-on-demand-no-timer",children:"Pattern 1: Publish on Demand (No Timer)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class OnDemandPublisher(Node):\n    def __init__(self):\n        super().__init__('on_demand_publisher')\n        self.publisher_ = self.create_publisher(String, 'events', 10)\n\n    def publish_event(self, event_data):\n        msg = String()\n        msg.data = event_data\n        self.publisher_.publish(msg)\n        self.get_logger().info(f'Published: {event_data}')\n"})}),"\n",(0,r.jsx)(n.h3,{id:"pattern-2-subscriber-that-republishes",children:"Pattern 2: Subscriber That Republishes"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class Relay(Node):\n    def __init__(self):\n        super().__init__('relay')\n\n        self.subscription = self.create_subscription(\n            String, 'input_topic', self.callback, 10\n        )\n        self.publisher_ = self.create_publisher(\n            String, 'output_topic', 10\n        )\n\n    def callback(self, msg):\n        # Process or transform the message\n        processed_msg = String()\n        processed_msg.data = msg.data.upper()\n        self.publisher_.publish(processed_msg)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"pattern-3-multi-subscriber-node",children:"Pattern 3: Multi-Subscriber Node"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class MultiSubscriber(Node):\n    def __init__(self):\n        super().__init__('multi_subscriber')\n\n        self.sub1 = self.create_subscription(\n            String, 'topic1', self.callback1, 10\n        )\n        self.sub2 = self.create_subscription(\n            String, 'topic2', self.callback2, 10\n        )\n\n    def callback1(self, msg):\n        self.get_logger().info(f'Topic1: {msg.data}')\n\n    def callback2(self, msg):\n        self.get_logger().info(f'Topic2: {msg.data}')\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"debugging-tips",children:"Debugging Tips"}),"\n",(0,r.jsx)(n.h3,{id:"problem-node-not-receiving-messages",children:"Problem: Node Not Receiving Messages"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Are both nodes running?"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 node list\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Is the topic name correct?"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 topic list\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Are messages being published?"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 topic echo /chatter\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"problem-importerror-for-message-types",children:"Problem: ImportError for Message Types"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Wrong\nfrom std_msgs import String\n\n# Correct\nfrom std_msgs.msg import String\n"})}),"\n",(0,r.jsx)(n.h3,{id:"problem-node-exits-immediately",children:"Problem: Node Exits Immediately"}),"\n",(0,r.jsxs)(n.p,{children:["Make sure you call ",(0,r.jsx)(n.code,{children:"rclpy.spin()"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Without spin, the node will exit immediately\nrclpy.spin(node)  # Don't forget this!\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"hands-on-exercise",children:"Hands-On Exercise"}),"\n",(0,r.jsx)(n.h3,{id:"exercise-1-temperature-monitor",children:"Exercise 1: Temperature Monitor"}),"\n",(0,r.jsx)(n.p,{children:"Create two nodes:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Temperature Publisher"}),": Publishes random temperature readings every second"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Temperature Monitor"}),": Subscribes and logs a warning if temperature > 30\xb0C"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Hints:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import random\n\n# In publisher\ntemp = random.uniform(15.0, 35.0)\nmsg.data = f'{temp:.2f}'\n\n# In subscriber\nif float(msg.data) > 30.0:\n    self.get_logger().warn(f'High temperature: {msg.data}\xb0C')\n"})}),"\n",(0,r.jsx)(n.h3,{id:"exercise-2-counter-node",children:"Exercise 2: Counter Node"}),"\n",(0,r.jsx)(n.p,{children:"Create a node that:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Subscribes to ",(0,r.jsx)(n.code,{children:"/increment"})," topic (String messages)"]}),"\n",(0,r.jsx)(n.li,{children:"Maintains an internal counter"}),"\n",(0,r.jsx)(n.li,{children:"Increments counter each time a message is received"}),"\n",(0,r.jsxs)(n.li,{children:["Publishes current count to ",(0,r.jsx)(n.code,{children:"/count"})," topic"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(n.p,{children:"You've learned to:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Create publisher and subscriber nodes in Python"}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"rclpy"})," for ROS 2 communication"]}),"\n",(0,r.jsx)(n.li,{children:"Understand the node lifecycle"}),"\n",(0,r.jsx)(n.li,{children:"Run and test nodes with CLI tools"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Takeaways:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Nodes inherit from ",(0,r.jsx)(n.code,{children:"rclpy.node.Node"})]}),"\n",(0,r.jsx)(n.li,{children:"Publishers send messages to topics"}),"\n",(0,r.jsx)(n.li,{children:"Subscribers receive messages via callbacks"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"rclpy.spin()"})," keeps the node alive"]}),"\n",(0,r.jsx)(n.li,{children:"Always initialize and shutdown properly"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/physical-ai-humanoid-robotics/docs/module-1-ros2/ch2-python-rclpy/message-types",children:"Message Types"})," - Learn about different ROS 2 message types"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/physical-ai-humanoid-robotics/docs/module-1-ros2/ch2-python-rclpy/timers-callbacks",children:"Timers and Callbacks"})," - Advanced callback patterns"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/physical-ai-humanoid-robotics/docs/module-1-ros2/ch2-python-rclpy/parameters",children:"Parameters"})," - Make your nodes configurable"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"additional-resources",children:"Additional Resources"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.ros2.org/latest/api/rclpy/",children:"rclpy API Documentation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Writing-A-Simple-Py-Publisher-And-Subscriber.html",children:"ROS 2 Python Tutorial"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(2592).A+"",children:"Complete Publisher Example"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(1100).A+"",children:"Complete Subscriber Example"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>a});var i=s(6540);const r={},l=i.createContext(r);function t(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);